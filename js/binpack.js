function Rect(a,b,c,d){this.x=a;this.y=b;this.w=c;this.h=d}Rect.prototype.fits_in=function(a){return a.w>=this.w&&a.h>=this.h};Rect.prototype.same_size_as=function(a){return this.w==a.w&&this.h==a.h};function Node(a){this.right=this.left=null;this.rect=a||new Rect(512,512);this.filled=!1}
Node.prototype.insert_rect=function(a){if(null!=this.left)return this.left.insert_rect(a)||this.right.insert_rect(a);if(this.filled||!a.fits_in(this.rect))return null;if(a.same_size_as(this.rect))return this.filled=!0,this;this.left=new Node;this.right=new Node;var b=this.rect;this.rect.w-a.w>this.rect.h-a.h?(this.left.rect=new Rect(b.x,b.y,a.w,b.h),this.right.rect=new Rect(b.x+a.w,b.y,b.w-a.w,b.h)):(this.left.rect=new Rect(b.x,b.y,b.w,a.h),this.right.rect=new Rect(b.x,b.y+a.h,b.w,b.h-a.h));return this.left.insert_rect(a)};